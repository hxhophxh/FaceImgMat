# FaceImgMat 使用说明书（精简版）

本文为产品级的快速上手指南，适用于首次部署与日常使用者，涵盖产品简介、前置条件、部署方式（含离线一键部署）、常见问题与运维要点。

## 产品简介
FaceImgMat 是一款可本地部署的人脸图片管理与相似度匹配服务，提供简洁的 Web 界面与脚本工具，支持：
- 人脸检测、人脸向量提取与相似度匹配
- 图片上传与批量处理
- 本地数据库持久化，离线可用
- Windows 一键离线部署，自动创建桌面快捷方式

默认本机访问地址：
- http://127.0.0.1:5000 （启动后约 6 秒自动打开）

## 前置条件与环境要求
- 操作系统：Windows 10/11 64 位
- 硬件：普通办公电脑可用（CPU 推理），建议预留数 GB 磁盘空间
- 权限：建议使用具备软件安装与写入权限的账户
- 网络：
  - 在线部署需要可访问 GitHub Releases（用于下载离线包/依赖）。
  - 如访问 GitHub 较慢，请耐心等待或多次重试；必要时配置网络代理；无法联网时使用“离线一键部署”。
- 端口：5000 未被占用（Web 服务端口）

## 部署方式概览
- 离线一键部署（推荐内网/无网）：运行 `super-offline-deployment/一键完整部署.bat` 自动完成环境准备与启动。
- 在线部署（概览）：安装 Python 3.12，创建虚拟环境，安装依赖后运行 `start.bat`。

更多关于离线一键部署的详细步骤，见《OFFLINE-ONE-CLICK-GUIDE.md》。

## 在线部署（仅概览）
1) 安装 Python 3.12（x64），确保 `python` 在 PATH 中。
2) 在项目根目录创建并激活虚拟环境（`.venv`）。
3) 安装依赖：`pip install -r requirements.txt`（或 `requirements.lock`）。
4) 启动：运行 `start.bat`（或 `start.ps1` / `start.sh`）。

如网络不稳定，依赖安装可能耗时较久；可重试或改用离线部署。

## 常见问题（FAQ）
- GitHub 下载慢/失败：耐心等待、多次重试；或提前将 `offline_bundle.zip` 放入 `super-offline-deployment/`。
- 端口 5000 被占用：关闭占用程序后再启动；或调整启动端口（高级场景）。
- Python 安装失败：手动运行 `01-Python安装包/python-3.12.7-amd64.exe`，再从步骤 2/3 继续。
- 依赖安装失败：确认 `offline_bundle/wheels/` 与 `offline_bundle/site-packages/` 完整可读；从步骤 4 重试。
- 模型文件缺失：确认 `offline_bundle/models/insightface_models/` 存在；从步骤 5 重试。

## 日志、数据与维护
- 日志目录：`logs/`
- 数据库：`instance/face_matching.db`
- 启动脚本：`start.bat`（Windows），`start.ps1`（PowerShell），`start.sh`（Linux/Mac）
- 升级建议：备份 `instance/` 与 `logs/` 后，替换为新版本离线包并重新执行部署。
- 卸载清理：`super-offline-deployment/卸载清理.bat` 或手动删除生成目录与快捷方式。

## 安全与合规
- 建议在可信内网使用，限制外部访问。
- 服务器长期运行时，配合防火墙策略并限制管理界面访问。
- 处理含人脸信息的图片需遵守法律法规与内部规范。

—
如需更详细的部署与排障，请参见 `docs/` 目录中的其他指南与离线部署说明。