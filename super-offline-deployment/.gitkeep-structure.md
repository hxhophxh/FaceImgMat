# 超级离线部署包目录结构说明

## 📂 目录说明

本目录用于准备和存放 FaceImgMat 的**完整离线部署包**。

### 目录结构

```
super-offline-deployment/
├── 00-使用说明/              ✅ 已提交到 GitHub
│   ├── 如何获取依赖文件.md   
│   └── 快速开始.txt
│
├── 01-Python安装包/           ⚠️ 大文件不提交（需本地准备）
│   ├── README.md             ✅ 已提交
│   ├── 安装Python说明.txt    ✅ 已提交
│   └── python-3.12.7-amd64.exe  ❌ 不提交（~26MB）
│
├── 02-项目源码/               ⚠️ 避免重复，不提交源码副本
│   ├── README.md             ✅ 已提交
│   └── FaceImgMat/           ❌ 不提交（由脚本自动复制）
│
├── 03-Python依赖包/           ⚠️ 大文件不提交（需本地下载）
│   ├── README.md             ✅ 已提交
│   └── *.whl (100+ 个包)     ❌ 不提交（~200MB）
│
├── 04-AI模型文件/             ⚠️ 超大文件不提交
│   ├── README.md             ✅ 已提交
│   └── insightface_models/   ❌ 不提交（~500MB）
│
├── *.bat                     ✅ 所有批处理脚本已提交
├── *.ps1                     ✅ 所有 PowerShell 脚本已提交
├── *.md                      ✅ 所有文档已提交
└── *.txt                     ✅ 所有说明文件已提交
```

---

## 🎯 使用方法

### 1️⃣ 从 GitHub 克隆仓库后

克隆仓库后，您会获得：
- ✅ 所有脚本文件（.bat, .ps1）
- ✅ 所有文档文件（.md, .txt）
- ✅ 目录结构和 README

但**不包含**大文件（Python 安装包、依赖包、AI 模型）

### 2️⃣ 准备完整离线包

在**有网络的机器**上运行：

```powershell
cd super-offline-deployment
.\准备超级离线包.bat
```

或英文版：

```powershell
.\prepare-super-offline.bat
```

这个脚本会：
1. ✅ 创建完整目录结构
2. ⬇️ 下载 Python 3.12.7 安装程序（~26MB）
3. 📋 复制项目源码到 02-项目源码/
4. ⬇️ 下载所有 Python 依赖包（~200MB）
5. 📋 复制 InsightFace AI 模型（~500MB）
6. ✅ 验证完整性

**预计时间**：15-25 分钟  
**所需空间**：约 2GB

### 3️⃣ 在目标机器部署

准备完成后，可以：

**选项 A**：直接在本机部署
```powershell
.\一键完整部署.bat
```

**选项 B**：传输到其他机器
```powershell
# 1. 压缩整个目录
Compress-Archive -Path "super-offline-deployment" `
                 -DestinationPath "FaceImgMat-超级离线包.zip"

# 2. 传输到目标机器（U盘/网络）

# 3. 在目标机器解压并运行
.\一键完整部署.bat
```

---

## 📝 为什么不把大文件提交到 GitHub？

1. **GitHub 单文件限制**：100MB（我们的文件总计 ~2GB）
2. **减少仓库大小**：保持仓库轻量，克隆更快
3. **灵活性**：可以在任何有网络的地方重新下载最新版本
4. **节省带宽**：不需要重复下载相同的文件

---

## 🔍 .gitignore 规则

仓库使用以下规则（在根目录 `.gitignore`）：

```gitignore
# 排除 Python 安装程序
super-offline-deployment/01-Python安装包/*.exe

# 排除 Python 依赖包
super-offline-deployment/03-Python依赖包/*.whl
super-offline-deployment/03-Python依赖包/*.tar.gz

# 排除 AI 模型
super-offline-deployment/04-AI模型文件/insightface_models/*/*.onnx
super-offline-deployment/04-AI模型文件/insightface_models/*.zip

# 排除复制的源码（避免重复）
super-offline-deployment/02-项目源码/FaceImgMat/
```

---

## 📦 提交到 GitHub 的文件清单

✅ **已提交的文件**（约 300KB）：

- 📄 所有 `.bat` 脚本（一键部署、准备、卸载等）
- 📄 所有 `.ps1` 脚本（PowerShell 准备脚本）
- 📄 所有 `.md` 文档（README、指南、说明）
- 📄 所有 `.txt` 文本（使用说明、快速开始）
- 📂 各子目录的 README.md

❌ **未提交的文件**（约 2GB）：

- 🚫 Python 安装程序（~26MB × 2 = 52MB）
- 🚫 Python 依赖包（~200MB）
- 🚫 AI 模型文件（~500MB）
- 🚫 复制的项目源码（避免重复）

---

## 🛠️ 开发者注意事项

### 修改脚本后

如果修改了任何 `.bat` 或 `.ps1` 脚本：

```powershell
# 1. 测试脚本
.\准备超级离线包.bat

# 2. 确认无误后提交
git add super-offline-deployment/*.bat
git add super-offline-deployment/*.ps1
git commit -m "更新部署脚本"
git push
```

### 更新文档后

```powershell
git add super-offline-deployment/*.md
git add super-offline-deployment/*.txt
git commit -m "更新部署文档"
git push
```

### 添加新脚本

新的脚本会自动被 Git 跟踪（除非是大文件）：

```powershell
# 创建新脚本
New-Item "super-offline-deployment/新脚本.bat"

# 添加并提交
git add "super-offline-deployment/新脚本.bat"
git commit -m "添加新脚本"
git push
```

---

## ✅ 验证完整性

### 检查 GitHub 仓库

```powershell
# 克隆仓库
git clone https://github.com/hxhophxh/FaceImgMat.git

# 检查 super-offline-deployment 目录
cd FaceImgMat/super-offline-deployment
ls

# 应该看到：
# ✅ 所有 .bat 文件
# ✅ 所有 .ps1 文件
# ✅ 所有 .md 文件
# ✅ 4个子目录（00-使用说明, 01-Python安装包, 02-项目源码, 03-Python依赖包, 04-AI模型文件）
# ✅ 每个子目录有 README.md
```

### 准备完整包后检查

```powershell
# 运行准备脚本后
.\准备超级离线包.bat

# 检查完整性
dir 01-Python安装包\*.exe        # 应该有 Python 安装程序
dir 03-Python依赖包\*.whl        # 应该有 100+ 个包
dir 04-AI模型文件\insightface_models\  # 应该有模型文件
dir 02-项目源码\FaceImgMat\      # 应该有完整项目
```

---

## 📞 需要帮助？

- 📖 查看 `README-USER.md` - 用户使用指南
- 📖 查看 `DEPLOYMENT-GUIDE.md` - 详细部署文档
- 📖 查看 `00-使用说明/如何获取依赖文件.md` - 依赖获取指南
- 🐛 遇到问题？在 GitHub 提 Issue

---

## 🎉 总结

这个目录设计实现了：

- ✅ **脚本和文档**都在 GitHub 版本控制下
- ✅ **大文件**不占用仓库空间
- ✅ **可重复构建**：任何人都可以从脚本重新生成完整包
- ✅ **灵活传输**：可以只传脚本，也可以传完整包

**最佳实践**：
1. 开发时提交脚本和文档到 GitHub
2. 发布时在本地准备完整离线包
3. 通过 U盘或文件服务器分发完整包
