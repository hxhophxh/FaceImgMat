# ✅ FaceImgMat 一键部署完整使用流程

## 🎯 核心流程（两步）

### 📍 操作目录：`super-offline-deployment`

---

## 第1步：准备完整离线包

### 📌 在哪里？
```
super-offline-deployment/准备超级离线包.bat
```

### 📌 什么时候运行？
- ✅ 第一次使用时
- ✅ 在**有网络**的机器上
- ✅ 需要下载约 2GB 的依赖文件

### 📌 做什么？
```bash
双击运行：准备超级离线包.bat
```

### 📌 脚本会自动完成：
1. ✅ 创建完整目录结构
2. ⬇️ 下载 Python 3.12.7 安装程序（~26MB）
3. 📋 复制项目源码到 `02-项目源码/FaceImgMat/`
4. ⬇️ 下载 100+ 个 Python 依赖包（~200MB）到 `03-Python依赖包/`
5. 📋 复制 InsightFace AI 模型（~500MB）到 `04-AI模型文件/`
6. ✅ 验证所有文件完整性

### 📌 预计时间：
- ⏱️ **15-25 分钟**（取决于网速）

### 📌 完成后：
```
super-offline-deployment/
├── 01-Python安装包/
│   └── python-3.12.7-amd64.exe       ✅ 已下载
├── 02-项目源码/
│   └── FaceImgMat/                   ✅ 已复制
├── 03-Python依赖包/
│   └── *.whl (100+ 个包)             ✅ 已下载
└── 04-AI模型文件/
    └── insightface_models/            ✅ 已复制
```

---

## 第2步：一键完整部署

### 📌 在哪里？
```
super-offline-deployment/一键完整部署.bat
```

### 📌 什么时候运行？
- ✅ 在完成「第1步：准备」之后
- ✅ 可以在**离线机器**上运行
- ✅ 也可以在原机器上直接部署

### 📌 做什么？
```bash
双击运行：一键完整部署.bat
```

### 📌 脚本会自动完成：
1. ✅ 检测并安装 Python 3.12.7
2. ✅ 创建 Python 虚拟环境
3. ✅ 安装所有 Python 依赖包（从本地）
4. ✅ 配置 InsightFace AI 模型
5. ✅ 初始化数据库
6. ✅ 启动 Flask Web 服务
7. 🌐 自动打开浏览器

### 📌 预计时间：
- ⏱️ **15-20 分钟**

### 📌 完成后：
浏览器会自动打开：
```
🔗 地址：http://127.0.0.1:5000
👤 账号：admin
🔑 密码：Admin@FaceMatch2025!
```

⚠️ **重要**：首次登录后请立即修改密码！

---

## 📊 完整时间线

```
开始
  │
  ├─ 第1步：准备离线包（15-25分钟）【需要网络】
  │   ├─ 下载 Python 安装包（1-2分钟）
  │   ├─ 下载 Python 依赖包（8-12分钟）
  │   ├─ 下载 AI 模型（5-10分钟）
  │   └─ 复制项目源码（1分钟）
  │
  ├─ 第2步：一键部署（15-20分钟）【可以离线】
  │   ├─ 安装 Python（2-5分钟）
  │   ├─ 创建虚拟环境（1分钟）
  │   ├─ 安装依赖包（5-10分钟）
  │   ├─ 配置 AI 模型（2-3分钟）
  │   ├─ 初始化数据库（1分钟）
  │   └─ 启动服务（1分钟）
  │
  └─ 完成！浏览器自动打开
  
总计：30-45 分钟（全自动）
```

---

## 🎬 使用场景

### 场景1：开发者首次使用（有网）

```bash
# 1. 从 GitHub 克隆仓库
git clone https://github.com/hxhophxh/FaceImgMat.git
cd FaceImgMat/super-offline-deployment

# 2. 准备离线包
.\准备超级离线包.bat
# 等待 15-25 分钟

# 3. 部署系统
.\一键完整部署.bat
# 等待 15-20 分钟

# 4. 完成！浏览器自动打开
```

---

### 场景2：内网部署（无网）

```bash
# 在有网的机器上：
# 1. 准备完整离线包
cd super-offline-deployment
.\准备超级离线包.bat

# 2. 压缩整个目录
Compress-Archive -Path "super-offline-deployment" `
                 -DestinationPath "FaceImgMat-完整包.zip"

# 3. 传输到目标机器（U盘/内网共享）

# 在目标机器上：
# 4. 解压
Expand-Archive -Path "FaceImgMat-完整包.zip" -DestinationPath "D:\FaceImgMat"

# 5. 部署
cd D:\FaceImgMat\super-offline-deployment
.\一键完整部署.bat

# 6. 完成！
```

---

### 场景3：多台机器部署

```bash
# 准备一次，多次使用：

# 第一台机器（有网）：
.\准备超级离线包.bat
Compress-Archive -Path "super-offline-deployment" -DestinationPath "离线包.zip"

# 其他机器（可离线）：
解压 → .\一键完整部署.bat
```

---

## 💾 空间要求

| 阶段 | 空间需求 | 说明 |
|------|----------|------|
| **准备阶段** | ~5GB | 存储下载的所有文件 |
| **部署后** | ~3.5GB | Python + 依赖 + 模型 |
| **推荐** | 10GB+ | 预留足够空间 |

---

## 📁 目录对比

### user-package/（轻量级，约10MB）
```
user-package/
├── 开始阅读.txt           ← 快速指南
├── 快速参考手册.md        ← 参考文档
└── 00-管理员文档/         ← 管理员资料

用途：文档参考，不用于实际部署
```

### super-offline-deployment/（完整包，约2GB）⭐
```
super-offline-deployment/
├── 00-使用说明/           ← 详细文档
├── 01-Python安装包/       ← Python 安装程序
├── 02-项目源码/           ← 完整源码
├── 03-Python依赖包/       ← 所有依赖
├── 04-AI模型文件/         ← AI 模型
├── 准备超级离线包.bat     ⭐ 第1步
└── 一键完整部署.bat       ⭐ 第2步

用途：实际部署使用
```

---

## ❓ 常见问题

### Q1: 我应该从哪个目录开始？

**A:** `super-offline-deployment` 目录，不是 `user-package` 目录。

### Q2: 必须先运行准备脚本吗？

**A:** 
- ✅ 首次使用时必须运行（下载依赖）
- ✅ 如果已有完整离线包，可以跳过
- ✅ 准备一次，可以多次使用

### Q3: 准备脚本可以在离线机器运行吗？

**A:** ❌ 不可以。准备脚本需要网络下载文件。但准备完成后，部署脚本可以离线运行。

### Q4: 可以在多台机器使用吗？

**A:** ✅ 可以！准备一次后：
1. 压缩 `super-offline-deployment` 目录
2. 传输到其他机器
3. 解压后运行 `一键完整部署.bat`

### Q5: 如果准备脚本失败了？

**A:** 可以重复运行，已下载的文件会被跳过或覆盖。

### Q6: Python 版本可以改吗？

**A:** 可以，修改 `prepare-super-package.ps1` 中的版本号和下载地址。

---

## 🔧 高级选项

### 如果已安装 Python 3.11/3.12

```bash
# 可以跳过 Python 安装
.\仅部署项目.bat
```

### 如果需要卸载

```bash
# 完整卸载系统
.\卸载清理.bat
```

---

## 📖 更多文档

- 📄 `super-offline-deployment/README-USER.md` - 用户使用指南
- 📄 `super-offline-deployment/用户使用说明.txt` - 详细操作手册
- 📄 `super-offline-deployment/00-使用说明/如何获取依赖文件.md` - 依赖说明
- 📄 `super-offline-deployment/.gitkeep-structure.md` - 目录结构说明
- 📄 `user-package/快速参考手册.md` - 快速参考

---

## ✅ 总结

### 核心流程：
1. **准备**：在有网的机器运行 `准备超级离线包.bat`
2. **部署**：运行 `一键完整部署.bat`
3. **完成**：浏览器自动打开系统

### 关键点：
- ✅ 使用 `super-offline-deployment` 目录
- ✅ 第1步需要网络，第2步可离线
- ✅ 准备一次，多次使用
- ✅ 全程自动，无需手动干预

---

**🎉 就这么简单！**

需要帮助？查看 `super-offline-deployment/00-使用说明/` 目录中的详细文档。
